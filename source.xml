<source name="Weather" codepage="ACP" datafiletype="char" fieldterminator="\r\n">
	<description>http://www.slb.mf.stockholm.se</description>
    <part name="Temperature" nulls="" charskip="4"> 
        SELECT * FROM SMHI_Weather_Raw WHERE [row] LIKE 'TEMP%'
        <term name="date" size="6" format="date">
            CASE LEFT([date],1) WHEN '0' THEN '20' + [date] ELSE '19' + [date] END
        </term>
        <term name="hour" size="4" format="char(2)">
            LEFT([hour], 2)
        </term>
        <term name="celsius" delimiter=" " format="decimal(19,10)"/>
        <calculation name="fahrenheit" format="decimal(19,10)">
            9 / 5 * [celsius] + 32
        </calculation>
        <calculation name="freezing" format="char(1)">
            CASE 
                WHEN [celsius] &gt; 0 THEN 'A' 
                WHEN [celsius] &lt; 0 THEN 'B' 
                WHEN [celsius] = 0 THEN 'Z' 
                ELSE '?' 
            END
        </calculation>
        <key name="measureTime" type="primary">
            <component of="date"/>
            <component of="hour"/>
        </key>
    </part>
    <part name="Pressure" nulls="">
        SELECT * FROM SMHI_Weather_Raw WHERE [row] LIKE 'PRSR%'
        <term name="date" size="6" format="date">
            CASE LEFT([date],1) WHEN '0' THEN '20' + [date] ELSE '19' + [date] END
        </term>
        <term name="hour" size="4" format="char(2)">
            LEFT([hour], 2)
        </term>
        <term name="pressure" size="10" format="decimal(19,10)"/>
        <key name="measureTime" type="primary">
            <component of="date"/>
            <component of="hour"/>
        </key>        
    </part>
    <part name="Wind" nulls="">
        SELECT * FROM SMHI_Weather_Raw WHERE [row] LIKE 'WNDS%'
        <term name="date" size="6" format="date">
            CASE LEFT([date],1) WHEN '0' THEN '20' + [date] ELSE '19' + [date] END
        </term>
        <term name="hour" size="4" format="char(2)">
            LEFT([hour], 2)
        </term>
        <term name="direction" size="10" format="int"/>
        <term name="speed" size="10" format="decimal(19,10)"/>
        <key name="measureTime" type="primary">
            <component of="date"/>
            <component of="hour"/>
        </key>
    </part>
</source>
